<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>WebSocket</title>
<script src="https://cdn.bootcss.com/sockjs-client/1.3.0/sockjs.min.js"></script>
<script src="https://cdn.bootcss.com/stomp.js/2.3.3/stomp.js"></script>
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>
<body>
	<noscript>
		<h2 style="color: #e80b0a;">Sorry，浏览器不支持WebSocket</h2>
	</noscript>
	<div>
		<div>
			<!-- <button id="connect" onclick="connect();">连接</button> -->
			<!-- <button id="disconnect" disabled="disabled" onclick="disconnect();">断开连接</button> -->
		</div>

		<div id="conversationDiv">
			<label>输入框</label>
			<textarea id="sayTxt" name="txt" clos=",50" rows="5" warp="virtual"></textarea>
			<button id="sendTxt" onclick="sendTxt();">发送</button>
		</div>
		<div id="conversationDiv2">
			<label>接收</label>
			<input type="text" id="name" />
		</div>
	</div>
	<script type="text/javascript">
		//socket = new WebSocket("ws://localhost:9094/starManager/websocket/张三");
		var socket;
		if (typeof (WebSocket) == "undefined") {
			console.log("您的浏览器不支持WebSocket");
		} else {
			console.log("您的浏览器支持WebSocket");

			//实现化WebSocket对象，指定要连接的服务器地址与端口  建立连接
			//socket = new WebSocket("ws://localhost:9094/starManager/websocket/张三")
			socket = new WebSocket("ws://localhost:8080/websocket");
			//打开事件
			socket.onopen = function() {
				console.log("Socket 已打开");
				//socket.send("这是来自客户端的消息" + location.href + new Date());
			};
			//接收消息事件
			socket.onmessage = function(msg) {
				console.log(msg.data);
				//发现消息进入    调后台获取
				//getCallingList();
				$("#name").val(msg.data);
			};
			//关闭事件
			socket.onclose = function() {
				console.log("Socket已关闭");
			};
			//发生了错误事件
			socket.onerror = function() {
				alert("Socket发生了错误");
			};
			$(window).unload(function() {
				socket.close();
			});
			//
			//                    		$("#btnClose").click(function() {
			//                    			socket.close();
			//                    		});
		}
		function sendTxt() {
			debugger
			var sayTxt = $("#sayTxt").val();
			socket.send(sayTxt);
		}
	</script>
</body>
</html>

